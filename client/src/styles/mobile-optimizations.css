/* Mobile Touch Optimizations */

/* Prevent touch callouts and text selection on interactive elements */
.touch-optimized {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* Improve touch targets for mobile */
@media (max-width: 768px) {
  /* Larger touch targets for buttons */
  button:not(.btn-compact) {
    min-height: 44px !important;
    min-width: 44px !important;
    padding: 0.5rem 1rem !important;
    touch-action: manipulation;
  }

  /* Larger touch targets for select triggers */
  [data-radix-select-trigger] {
    min-height: 44px !important;
    touch-action: manipulation;
  }

  /* Larger touch targets for tabs */
  [data-radix-tabs-trigger] {
    min-height: 44px !important;
    padding: 0.5rem 1rem !important;
    touch-action: manipulation;
  }

  /* Prevent zoom on input focus */
  input[type="text"],
  input[type="search"],
  input[type="email"],
  input[type="password"],
  textarea,
  select {
    font-size: 16px !important;
    touch-action: manipulation;
  }

  /* Improve scroll behavior for popovers and dropdowns */
  [data-radix-popover-content],
  [data-radix-dropdown-menu-content] {
    overscroll-behavior: contain;
    -webkit-overflow-scrolling: touch;
  }

  /* Prevent popovers from closing on scroll inside content */
  [data-radix-popover-content] {
    touch-action: pan-y;
  }

  /* Better spacing for mobile resource cards */
  .mobile-resource-card {
    min-height: 60px;
    padding: 1rem;
    touch-action: manipulation;
  }

  /* Improve mobile layout for control buttons */
  .mobile-controls {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    width: 100%;
  }

  .mobile-controls > div {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: center;
  }

  /* Better mobile navigation */
  .mobile-nav-button {
    min-height: 48px;
    min-width: 48px;
    touch-action: manipulation;
    -webkit-touch-callout: none;
  }

  /* Improve popover positioning on mobile */
  [data-radix-popover-content] {
    max-width: calc(100vw - 2rem);
    max-height: 70vh;
    overflow-y: auto;
  }

  /* Better dialog sizing on mobile - but not sheets */
  [data-radix-dialog-content]:not([data-side]) {
    max-width: calc(100vw - 1rem);
    max-height: 95vh;
    width: 95vw;
    margin: auto;
    overflow-y: auto;
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }
  
  /* Ensure mobile-optimized dialogs are properly centered */
  [data-radix-dialog-content][data-mobile-optimized="true"] {
    left: 50% !important;
    right: auto !important;
    transform: translate(-50%, -50%) !important;
    max-width: min(95vw, 28rem) !important;
  }
  
  /* Fix for all dialogs on mobile to prevent off-screen rendering - but not sheets */
  [data-radix-dialog-content]:not([data-side]) {
    --dialog-width: calc(100vw - 2rem);
    width: var(--dialog-width) !important;
    max-width: min(var(--dialog-width), 32rem) !important;
    left: 50% !important;
    transform: translateX(-50%) translateY(-50%) !important;
  }
  
  /* Exception for sheets - don't center them */
  [data-radix-dialog-content][data-side] {
    left: 0 !important;
    right: auto !important;
    top: 0 !important;
    bottom: 0 !important;
    transform: none !important;
    width: var(--sidebar-width, 18rem) !important;
    max-width: 85vw !important;
    padding-left: env(safe-area-inset-left);
  }
  
  /* Sidebar fixes for mobile */
  [data-sidebar] {
    z-index: 50;
  }
  
  /* Ensure content doesn't overflow on mobile */
  .grid {
    width: 100%;
    overflow-x: hidden;
  }
  
  /* Resource cards should be touch-friendly */
  [data-testid="resource-card"] {
    min-height: 60px;
    padding: 0.75rem;
    touch-action: manipulation;
  }

  /* Improve sheet behavior on mobile */
  [data-radix-dialog-content][data-state="open"] {
    animation-duration: 0.3s;
  }
}

/* Prevent text selection on buttons and interactive elements */
button,
[role="button"],
[data-radix-select-trigger],
[data-radix-dropdown-menu-trigger],
[data-radix-popover-trigger],
[data-radix-tabs-trigger] {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* Better focus states for mobile */
@media (max-width: 768px) {
  *:focus-visible {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 2px;
  }

  /* Remove hover states on mobile */
  @media (hover: none) {
    .hover\:bg-accent:hover {
      background-color: transparent;
    }
    
    .hover\:bg-accent\/50:hover {
      background-color: transparent;
    }
  }
}

/* Enhanced scroll lock for mobile */
body.scroll-lock,
html.scroll-lock {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  height: 100% !important;
  touch-action: none !important;
}

/* Maintain scroll position when lock is removed */
body.scroll-lock {
  top: var(--scroll-top, 0) !important;
}

/* Ensure sidebar overlay and content are above page content */
[data-radix-dialog-overlay] {
  z-index: 70 !important;
}

[data-radix-dialog-content][data-side] {
  z-index: 80 !important;
}

/* Mobile-specific popover improvements */
@media (max-width: 768px) {
  /* Make popovers full-width on very small screens */
  @media (max-width: 480px) {
    [data-radix-popover-content] {
      width: calc(100vw - 1rem);
      margin: 0.5rem;
      left: 0.5rem !important;
      right: 0.5rem !important;
      transform: none !important;
    }
    
    /* Fix dialog positioning on mobile */
    [data-radix-dialog-overlay] {
      position: fixed;
      inset: 0;
    }
    
    [data-radix-dialog-content]:not([data-side]) {
      position: fixed !important;
      left: 50% !important;
      top: 50% !important;
      transform: translate(-50%, -50%) !important;
      width: calc(100vw - 1rem) !important;
      max-width: 28rem !important;
      margin: 0 !important;
    }
    
    /* Keep sheets on the side even on very small screens */
    [data-radix-dialog-content][data-side] {
      position: fixed !important;
      left: 0 !important;
      top: 0 !important;
      transform: none !important;
      width: var(--sidebar-width, 18rem) !important;
      max-width: 80vw !important;
      height: 100% !important;
      margin: 0 !important;
    }
  }

  /* Improve touch scrolling */
  .scroll-area,
  [data-radix-scroll-area-viewport] {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
}